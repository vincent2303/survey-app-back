{"version":3,"sources":["../../passport-config/adminStrategy.js"],"names":["LocalStrategy","require","Strategy","User","loginStrategy","usernameField","pseudo","password","done","findOne","where","then","user","message","validPassword","salt","undefined","hash","module","exports"],"mappings":";;AAAA,IAAMA,aAAa,GAAGC,OAAO,CAAC,gBAAD,CAAP,CAA0BC,QAAhD;;AAEA,IAAMC,IAAI,GAAGF,OAAO,CAAC,iBAAD,CAAP,CAA2BE,IAAxC;;AAEA,IAAMC,aAAa,GAAG,IAAIJ,aAAJ,CACpB;AACEK,EAAAA,aAAa,EAAE;AADjB,CADoB,EAInB,UAACC,MAAD,EAASC,QAAT,EAAmBC,IAAnB,EAA4B;AAC3BL,EAAAA,IAAI,CAACM,OAAL,CAAa;AAAEC,IAAAA,KAAK,EAAE;AAAEJ,MAAAA,MAAM,EAAEA;AAAV;AAAT,GAAb,EAA4CK,IAA5C,CAAiD,UAACC,IAAD,EAAU;AACzD,QAAI,CAACA,IAAL,EAAW;AACT,aAAOJ,IAAI,CAAC,IAAD,EAAO,WAAP,EAAoB;AAAEK,QAAAA,OAAO,EAAE;AAAX,OAApB,CAAX;AACD;;AACD,QAAI,CAACD,IAAI,CAACE,aAAL,CAAmBP,QAAnB,CAAL,EAAmC;AACjC,aAAOC,IAAI,CAAC,IAAD,EAAO,WAAP,EAAoB;AAAEK,QAAAA,OAAO,EAAE;AAAX,OAApB,CAAX;AACD;;AACDD,IAAAA,IAAI,CAACG,IAAL,GAAYC,SAAZ;AACAJ,IAAAA,IAAI,CAACK,IAAL,GAAYD,SAAZ;AACA,WAAOR,IAAI,CAAC,IAAD,EAAOI,IAAP,CAAX;AACD,GAVD;AAWD,CAhBmB,CAAtB;AAmBAM,MAAM,CAACC,OAAP,GAAiBf,aAAjB","sourcesContent":["const LocalStrategy = require('passport-local').Strategy;\n\nconst User = require(\"../models/index\").User;\n\nconst loginStrategy = new LocalStrategy(\n  {\n    usernameField: \"pseudo\",\n  },\n  ((pseudo, password, done) => {\n    User.findOne({ where: { pseudo: pseudo } }).then((user) => {\n      if (!user) {\n        return done(null, \"wrongUser\", { message: 'Incorrect username.' });\n      }\n      if (!user.validPassword(password)) {\n        return done(null, \"wrongPass\", { message: 'Incorrect password.' });\n      }\n      user.salt = undefined;\n      user.hash = undefined;\n      return done(null, user);\n    });\n  }),\n);\n\nmodule.exports = loginStrategy;"],"file":"adminStrategy.js"}